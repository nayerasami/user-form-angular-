<h2 class="text-center my-2">{{isEdit? 'Update':'Add'}} User Form</h2>
<form [formGroup]="userForm" (ngSubmit)="onFormSubmit()">
  <div formGroupName="userInfo">
    <div class="row gy-3">
      <div class="col-md-6">
        <label for="firstNameAR" class="form-label"> الاسم الاول </label>
        <input
          type="text"
          class="form-control"
          id="firstNameAR"
          formControlName="firstNameAR"
        />
        <ng-container *ngIf="getControl('firstNameAR')?.touched">
          <p class="text-danger"
            *ngIf="getControl('firstNameAR')?.hasError('required')" >
            ادخل اسم مستخدم صحيح
          </p>
          <p class="text-danger"  *ngIf="getControl('firstNameAR')?.value && getControl('firstNameAR')?.hasError('minlength')">
            اسم المستخدم يجب الا يقل عن 3 حروف
          </p>
          <p class="text-danger" *ngIf="getControl('firstNameAR')?.value && getControl('firstNameAR')?.hasError('pattern')">
            أدخل اسم المستخدم باللغه العربيه        
             </p>
        </ng-container>
      </div>

      <div class="col-md-6">
        <label for="lastNameAR" class="form-label"> الاسم الثاني </label>
        <input
          type="text"
          class="form-control"
          id="lastNameAR"
          formControlName="lastNameAR"
        />
        <ng-container *ngIf="getControl('lastNameAR')?.touched">
          <p class="text-danger"
            *ngIf="getControl('lastNameAR')?.hasError('required')">
            ادخل اسم مستخدم صحيح
          </p>
          <p class="text-danger" *ngIf="getControl('lastNameAR')?.value &&  getControl('lastNameAR')?.hasError('minlength')">
            اسم المستخدم يجب الا يقل عن 3 حروف
          </p>
          <p class="text-danger"  *ngIf="getControl('lastNameAR')?.value && getControl('lastNameAR')?.hasError('pattern')">
            أدخل اسم المستخدم باللغه العربيه        
          </p>
        </ng-container>
      </div>

      <div class="col-md-6">
        <label for="firstNameEN" class="form-label"> First Name </label>
        <input
          type="text"
          class="form-control"
          id="firstNameEN"
          formControlName="firstNameEN"
        />
        <ng-container *ngIf="getControl('firstNameEN')?.touched">
          <p class="text-danger"
            *ngIf="getControl('firstNameEN')?.hasError('required')">
            Enter Valid Name
          </p>
          <p class="text-danger" *ngIf="getControl('firstNameEN')?.value && getControl('firstNameEN')?.hasError('minlength')">
            First Name must be at least 3
          </p>
          <p class="text-danger" *ngIf="getControl('firstNameEN')?.value && getControl('firstNameEN')?.hasError('pattern')">
            Enter User First Name In English
          </p>

        </ng-container>
      </div>
      <div class="col-md-6">
        <label for="lastNameEN" class="form-label"> Last Name </label>
        <input
          type="text"
          class="form-control"
          id="lastNameEN"
          formControlName="lastNameEN"
        />
        <ng-container *ngIf="getControl('lastNameEN')?.touched">
          <p class="text-danger"
            *ngIf="getControl('lastNameEN')?.hasError('required')" >
            Enter Valid Name
          </p>
          <p class="text-danger" *ngIf="getControl('lastNameEN')?.value && getControl('lastNameEN')?.hasError('minlength')">
            First Name must be at least 3
          </p>
          <p class="text-danger" *ngIf="getControl('lastNameEN')?.value && getControl('lastNameEN')?.hasError('pattern')">
            Enter User Last Name In English
          </p>

        </ng-container>
      </div>
      <div class="col-md-4">
        <label for="email" class="form-label"> email </label>
        <input
          type="email"
          class="form-control"
          id="email"
          formControlName="email"
        />
        <ng-container *ngIf="getControl('email')?.touched">
          <p class="text-danger"
            *ngIf="getControl('email')?.hasError('required')">
            User Email is required
          </p>

          <p class="text-danger"
            *ngIf="  getControl('email')?.value && getControl('email')?.hasError('pattern')">
            Enter a correct email format 
          </p>
          <p class="text-danger"
          *ngIf="getControl('email')?.hasError('emailTaken')">
           This email is already in use 
          
        </p>
        </ng-container>
      </div>
      <div class="col-md-1">  
                <app-reusable-ddl
        (selectionEvent)="getSelectedData($event ,'userInfo.phoneKey')"
        [ddlconfigOptions]="phoneKeysDDLConfig"
        [loading]="loading"
        #phoneKey
       ></app-reusable-ddl></div>
      <div class="col-md-3">

          <label for="phoneNumber" class="form-label"> phone </label>
          <input type="text" class="form-control" id="phoneNumber" formControlName="phoneNumber" customDirective="accept only numbers" />
          <ng-container *ngIf="getControl('phoneNumber')?.touched">
            <p class="text-danger" *ngIf="getControl('phoneNumber')?.hasError('required')">
              Phone number is required
            </p>
        
            <p class="text-danger" *ngIf="  getControl('phoneNumber')?.value  && getControl('phone')?.hasError('pattern')">
              Enter Valid phone number
            </p>
            <p class="text-danger" *ngIf="getControl('phoneNumber')?.hasError('phoneTaken')">
              This phone number already in use
            </p>
          </ng-container>

      </div>
      <div class="col-md-4">
        <label for="nationalID" class="form-label"> National ID </label>
        <input
          type="text"
          class="form-control"
          id="nationalID"
          formControlName="nationalID"
          customDirective="accept only numbers"
    
        />
        <ng-container *ngIf="getControl('nationalID')?.touched">
          <p class="text-danger"
            *ngIf="getControl('nationalID')?.hasError('required')">
            National ID is required
          </p>

          <p class="text-danger"
            *ngIf=" getControl('nationalID')?.value && getControl('nationalID')?.hasError('pattern')">
            Enter Valid national ID
          </p>
          <p class="text-danger"
          *ngIf="getControl('nationalID')?.hasError('nationalIDTaken')">
           This national id already in use 
        </p>
        </ng-container>
      </div>

      <div class="col-md-12">
        <label for="birthDate" class="form-label"> Birth Date </label>
        <input
          type="date"
          class="form-control"
          id="birthDate"
          formControlName="birthDate"
        />
        <ng-container *ngIf="getControl('birthDate')?.touched">
          <p  class="text-danger"
            *ngIf="getControl('birthDate')?.hasError('required')">
            Enter user birth date
          </p>
          <p
            class="text-danger"
            *ngIf=" getControl('birthDate').value &&
              getControl('birthDate')?.hasError('invalidDate')" >
            The date must be in the past
          </p>
        </ng-container>
      </div>
      <div class="col-md-6">
        <label for="addressAr" class="form-label"> Arabic Address </label>
        <input
          type="text"
          class="form-control"
          id="addressAr"
          formControlName="addressAr"
        />

        <ng-container *ngIf="getControl('addressAr')?.touched">
          <p class="text-danger"
            *ngIf="getControl('addressAr')?.hasError('required')">
            ادخل عنوان صحيح
          </p>

          <p class="text-danger"
            *ngIf="getControl('addressAr')?.value && getControl('addressAr')?.hasError('minlength')">
            يجب الا يقل العنوان عن 8 حروف
          </p>
          <p class="text-danger"
          *ngIf=" getControl('addressAr')?.value && getControl('addressAr')?.hasError('maxlength')">
          يجب الا يزيد العنوان عن 150 حروف
        </p>
          <p class="text-danger" *ngIf=" getControl('addressAr')?.value && getControl('addressAr')?.hasError('pattern')">
            أدخل عنوان المستخدم باللغه العربيه        
             </p>
        </ng-container>
      </div>
      <div class="col-md-6">
        <label for="addressEN" class="form-label"> English Address </label>
        <input
          type="text"
          class="form-control"
          id="addressEN"
          formControlName="addressEN"
        />
        <ng-container *ngIf="getControl('addressEN')?.touched">
          <p class="text-danger"
            *ngIf="getControl('addressEN')?.hasError('required')">
            Enter Valid Address
          </p>

          <p class="text-danger"
            *ngIf="getControl('addressEN')?.value && getControl('addressEN')?.hasError('minlength')" >
            Address must be at least 8
          </p>
          <p class="text-danger"
          *ngIf="getControl('addressEN')?.value && getControl('addressEN')?.hasError('maxlength')">
            User address should be max 150 characters
           </p>
           <p class="text-danger" *ngIf="getControl('addressEN')?.value && getControl('addressEN')?.hasError('pattern')">
            Enter User User Address In English
          </p>

        </ng-container>
        
      </div>
      <div class="col-md-6 d-flex justify-content-center align-items-center">
        <div>
          <label for="gender" class="form-label"> Gender </label>
        </div>
        <div>
          <app-reusable-ddl
            (selectionEvent)="getSelectedData($event, 'userInfo.gender')"
            [ddlconfigOptions]="genderDDLConfig"
            [loading]="loading"
            #genderDropList

            [options]="genderOptionsArr"
          ></app-reusable-ddl>
        </div>
      </div>
      <div class="col-md-6 d-flex justify-content-center align-items-center">
        <div>
          <label for="gender" class="form-label"> Marital Status </label>
        </div>
        <div>
          <app-reusable-ddl
            (selectionEvent)="getSelectedData($event, 'userInfo.maritalStatus')"
            [ddlconfigOptions]="maritalStatusDDLConfig"
            [loading]="loading"
            #maritalDropList
            [options]="maritalStatusOptionsArr"
          ></app-reusable-ddl>
        </div>
      </div>
    </div>
  </div>
  <hr />
  <div class="row " formArrayName="userExperience">
    <app-multi-inputs-control
    [formArray]="userExperiences"
      #userExperienceControl
      [controlOptions]="multiInputsOptions"
    ></app-multi-inputs-control>
  </div>
  <hr />

  <div class="row justify-content-center">
    <h5>select user permissions</h5>
    <div class="col-md-7">
      <app-reusable-pick-list
        (myEvent)="setPickedItemsValue($event)"
        #pickListEl
        [options]="pickListOptions"
      ></app-reusable-pick-list>
    </div>
  </div>

  <button class="btn btn-danger">{{isEdit? 'Update' :'Add'}} User</button>
  <p class="my-3" *ngIf="isSubmitted"><i class="bi bi-check-circle-fill text-success "></i> User {{ isEdit? 'Edited' :'Added'}} Successfully </p>
</form>
